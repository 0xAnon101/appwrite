<?php

use Utopia\App;
use Utopia\Config\Config;
use Appwrite\Database\Database;

$providers = Config::getParam('providers');

$collections = [
    'console' => [
        '$id' => 'console',
        '$collection' => 'projects',
        '$permissions' => ['read' => ['*']],
        'name' => 'Appwrite',
        'description' => 'Appwrite core engine',
        'logo' => '',
        'teamId' => -1,
        'webhooks' => [],
        'keys' => [],
        'platforms' => [
            [
                '$collection' => Database::COLLECTION_PLATFORMS,
                'name' => 'Production',
                'type' => 'web',
                'hostname' => 'appwrite.io',
            ],
            [
                '$collection' => Database::COLLECTION_PLATFORMS,
                'name' => 'Development',
                'type' => 'web',
                'hostname' => 'appwrite.test',
            ],
            [
                '$collection' => Database::COLLECTION_PLATFORMS,
                'name' => 'Localhost',
                'type' => 'web',
                'hostname' => 'localhost',
            ], // Current host is added on app init
        ],
        'legalName' => '',
        'legalCountry' => '',
        'legalState' => '',
        'legalCity' => '',
        'legalAddress' => '',
        'legalTaxId' => '',
        'authWhitelistEmails' => (!empty(App::getEnv('_APP_CONSOLE_WHITELIST_EMAILS', null))) ? \explode(',', App::getEnv('_APP_CONSOLE_WHITELIST_EMAILS', null)) : [],
        'authWhitelistIPs' => (!empty(App::getEnv('_APP_CONSOLE_WHITELIST_IPS', null))) ? \explode(',', App::getEnv('_APP_CONSOLE_WHITELIST_IPS', null)) : [],
        'authWhitelistDomains' => (!empty(App::getEnv('_APP_CONSOLE_WHITELIST_DOMAINS', null))) ? \explode(',', App::getEnv('_APP_CONSOLE_WHITELIST_DOMAINS', null)) : [],
    ],
    Database::COLLECTION_COLLECTIONS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_COLLECTIONS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Collections',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Created',
                'key' => 'dateCreated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Updated',
                'key' => 'dateUpdated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Rules',
                'key' => 'rules',
                'type' => Database::VAR_DOCUMENT,
                'default' => [],
                'required' => false,
                'array' => true,
                'list' => [Database::COLLECTION_RULES],
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Indexes',
                'key' => 'indexes',
                'type' => Database::VAR_DOCUMENT,
                'default' => [],
                'required' => false,
                'array' => true,
                'list' => [Database::COLLECTION_INDEXES],
            ],
        ],
        'indexes' => [
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system1',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'name',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system2',
                'type' => Database::INDEX_FULLTEXT,
                'attributes' => [
                    'name',
                ],
            ],
        ],
    ],
    Database::COLLECTION_RULES => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_RULES,
        '$permissions' => ['read' => ['*']],
        'name' => 'Collections Rule',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Label',
                'key' => 'label',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Key',
                'key' => 'key',
                'type' => Database::VAR_KEY,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Type',
                'key' => 'type',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Default',
                'key' => 'default',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Required',
                'key' => 'required',
                'type' => Database::VAR_BOOLEAN,
                'default' => true,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Array',
                'key' => 'array',
                'type' => Database::VAR_BOOLEAN,
                'default' => true,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'list',
                'key' => 'list',
                'type' => Database::VAR_TEXT,
                //'default' => '',
                'required' => false,
                'array' => true,
            ],
        ],
    ],
    Database::COLLECTION_INDEXES => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_INDEXES,
        '$permissions' => ['read' => ['*']],
        'name' => 'Collections Indexes',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Type',
                'key' => 'type',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Attributes',
                'key' => 'attributes',
                'type' => Database::VAR_KEY,
                'default' => '',
                'required' => true,
                'array' => true,
            ],
        ],
    ],
    Database::COLLECTION_USERS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_USERS,
        '$permissions' => ['read' => ['*']],
        'name' => 'User',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Email',
                'key' => 'email',
                'type' => Database::VAR_EMAIL,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Status',
                'key' => 'status',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Password',
                'key' => 'password',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Password Update Date',
                'key' => 'password-update',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Prefs',
                'key' => 'prefs',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
                'filter' => ['json']
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Registration Date',
                'key' => 'registration',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Email Verification Status',
                'key' => 'emailVerification',
                'type' => Database::VAR_BOOLEAN,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Reset',
                'key' => 'reset',
                'type' => Database::VAR_BOOLEAN,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Tokens',
                'key' => 'tokens',
                'type' => Database::VAR_DOCUMENT,
                'default' => [],
                'required' => false,
                'array' => true,
                'list' => [Database::COLLECTION_TOKENS],
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Memberships',
                'key' => 'memberships',
                'type' => Database::VAR_DOCUMENT,
                'default' => [],
                'required' => false,
                'array' => true,
                'list' => [Database::COLLECTION_MEMBERSHIPS],
            ],
        ],
        'indexes' => [
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system1',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'name',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system2',
                'type' => Database::INDEX_FULLTEXT,
                'attributes' => [
                    'name',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system3',
                'type' => Database::INDEX_UNIQUE,
                'attributes' => [
                    'email',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system4',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'email',
                ],
            ],
        ],
    ],
    Database::COLLECTION_TOKENS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_TOKENS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Token',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Type',
                'key' => 'type',
                'type' => Database::VAR_INTEGER,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Secret',
                'key' => 'secret',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Expire',
                'key' => 'expire',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'User Agent',
                'key' => 'userAgent',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'IP',
                'key' => 'ip',
                'type' => Database::VAR_IPV4,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'OS Code',
                'key' => 'osCode',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'OS Name',
                'key' => 'osName',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'OS Version',
                'key' => 'osVersion',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Client Type',
                'key' => 'clientType',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Client Code',
                'key' => 'clientCode',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Client Name',
                'key' => 'clientName',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Client Version',
                'key' => 'clientVersion',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Client Engine',
                'key' => 'clientEngine',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Client Engine Version',
                'key' => 'clientEngineVersion',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Device Name',
                'key' => 'deviceName',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Device Brand',
                'key' => 'deviceBrand',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Device Model',
                'key' => 'deviceModel',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Country Code',
                'key' => 'countryCode',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
    ],
    Database::COLLECTION_MEMBERSHIPS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_MEMBERSHIPS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Membership',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Team ID',
                'key' => 'teamId',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'User ID',
                'key' => 'userId',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Roles',
                'key' => 'roles',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => true,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Invited',
                'key' => 'invited',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false, //FIXME SHOULD BE REQUIRED
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Joined',
                'key' => 'joined',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Confirm',
                'key' => 'confirm',
                'type' => Database::VAR_BOOLEAN,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Secret',
                'key' => 'secret',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
        'indexes' => [
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system1',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'teamId',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system2',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'userId',
                ],
            ],
        ],
    ],
    Database::COLLECTION_TEAMS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_TEAMS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Team',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Created',
                'key' => 'dateCreated',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Sum',
                'key' => 'sum',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
        'indexes' => [
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system1',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'name',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system2',
                'type' => Database::INDEX_FULLTEXT,
                'attributes' => [
                    'name',
                ],
            ],
        ],
    ],
    Database::COLLECTION_PROJECTS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_PROJECTS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Project',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Description',
                'key' => 'description',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Logo',
                'key' => 'logo',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'URL',
                'key' => 'url',
                'type' => Database::VAR_URL,
                'default' => '',
                'required' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Team ID',
                'key' => 'teamId',
                'type' => Database::VAR_TEXT,
                'default' => 0,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Legal Name',
                'key' => 'legalName',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Legal Country',
                'key' => 'legalCountry',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Legal State',
                'key' => 'legalState',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Legal City',
                'key' => 'legalCity',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Legal Address',
                'key' => 'legalAddress',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Legal Tax ID',
                'key' => 'legalTaxId',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Webhooks',
                'key' => 'webhooks',
                'type' => Database::VAR_DOCUMENT,
                'default' => [],
                'required' => false,
                'array' => true,
                'list' => [Database::COLLECTION_WEBHOOKS],
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'API Keys',
                'key' => 'keys',
                'type' => Database::VAR_DOCUMENT,
                'default' => [],
                'required' => false,
                'array' => true,
                'list' => [Database::COLLECTION_KEYS],
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Tasks',
                'key' => 'tasks',
                'type' => Database::VAR_DOCUMENT,
                'default' => [],
                'required' => false,
                'array' => true,
                'list' => [Database::COLLECTION_TASKS],
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Platforms',
                'key' => 'platforms',
                'type' => Database::VAR_DOCUMENT,
                'default' => [],
                'required' => false,
                'array' => true,
                'list' => [Database::COLLECTION_PLATFORMS],
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Domains',
                'key' => 'domains',
                'type' => Database::VAR_DOCUMENT,
                'default' => [],
                'required' => false,
                'array' => true,
                'list' => [Database::COLLECTION_DOMAINS],
            ],
        ],
        'indexes' => [
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system1',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'name',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system2',
                'type' => Database::INDEX_FULLTEXT,
                'attributes' => [
                    'name',
                ],
            ],
        ],
    ],
    Database::COLLECTION_WEBHOOKS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_WEBHOOKS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Webhook',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Events',
                'key' => 'events',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => false,
                'array' => true,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'URL',
                'key' => 'url',
                'type' => Database::VAR_URL,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Security',
                'key' => 'security',
                'type' => Database::VAR_BOOLEAN,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'HTTP User',
                'key' => 'httpUser',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'HTTP Password',
                'key' => 'httpPass',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
    ],
    Database::COLLECTION_KEYS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_KEYS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Key',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Scopes',
                'key' => 'scopes',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => false,
                'array' => true,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Secret',
                'key' => 'secret',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
            ],
        ],
    ],
    Database::COLLECTION_TASKS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_TASKS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Task',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Status',
                'key' => 'status',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Updated',
                'key' => 'updated',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Schedule',
                'key' => 'schedule',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Previous',
                'key' => 'previous',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Next',
                'key' => 'next',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Duration',
                'key' => 'duration',
                'type' => Database::VAR_FLOAT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Delay',
                'key' => 'delay',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Security',
                'key' => 'security',
                'type' => Database::VAR_BOOLEAN,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'HTTP Method',
                'key' => 'httpMethod',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'HTTP URL',
                'key' => 'httpUrl',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'HTTP Headers',
                'key' => 'httpHeaders',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => false,
                'array' => true,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'HTTP User',
                'key' => 'httpUser',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'HTTP Password',
                'key' => 'httpPass',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Log',
                'key' => 'log',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Failures',
                'key' => 'failures',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
    ],
    Database::COLLECTION_PLATFORMS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_PLATFORMS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Platform',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Type',
                'key' => 'type',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Created',
                'key' => 'dateCreated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Updated',
                'key' => 'dateUpdated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Key',
                'key' => 'key',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Store',
                'key' => 'store',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Hostname',
                'key' => 'hostname',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
    ],
    Database::COLLECTION_DOMAINS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_DOMAINS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Domains',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Domain',
                'key' => 'domain',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Updated',
                'key' => 'updated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Top Level Domain',
                'key' => 'tld',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Registerable Domain',
                'key' => 'registerable',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Verification',
                'key' => 'verification',
                'type' => Database::VAR_BOOLEAN,
                'default' => false,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Certificate ID',
                'key' => 'certificateId',
                'type' => Database::VAR_KEY,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
    ],
    Database::COLLECTION_CERTIFICATES => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_CERTIFICATES,
        '$permissions' => ['read' => ['*']],
        'name' => 'Certificates',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Domain',
                'key' => 'domain',
                'type' => Database::VAR_TEXT,
                'default' => null,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Issue Date',
                'key' => 'issueDate',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Renew Date',
                'key' => 'renewDate',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Attempts',
                'key' => 'attempts',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Log',
                'key' => 'log',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
    ],
    Database::COLLECTION_FILES => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_FILES,
        '$permissions' => ['read' => ['*']],
        'name' => 'File',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Created',
                'key' => 'dateCreated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Folder ID',
                'key' => 'folderId',
                'type' => Database::VAR_KEY,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Path',
                'key' => 'path',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Signature',
                'key' => 'signature',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Mime Type',
                'key' => 'mimeType',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Original Size',
                'key' => 'sizeOriginal',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Actual Size',
                'key' => 'sizeActual',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Algorithm',
                'key' => 'algorithm',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Token',
                'key' => 'token',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => true,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Comment',
                'key' => 'comment',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'File OpenSSL Version',
                'key' => 'fileOpenSSLVersion',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'File OpenSSL Cipher',
                'key' => 'fileOpenSSLCipher',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'File OpenSSL Tag',
                'key' => 'fileOpenSSLTag',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'File OpenSSL IV',
                'key' => 'fileOpenSSLIV',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
        'indexes' => [
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system1',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'name',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system2',
                'type' => Database::INDEX_FULLTEXT,
                'attributes' => [
                    'name',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system3',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'mimeType',
                ],
            ],
        ],
    ],
    Database::COLLECTION_FUNCTIONS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_FUNCTIONS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Functions',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Created',
                'key' => 'dateCreated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Updated',
                'key' => 'dateUpdated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Status',
                'key' => 'status',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Name',
                'key' => 'name',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Env',
                'key' => 'env',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Tag',
                'key' => 'tag',
                'type' => Database::VAR_KEY,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Vars',
                'key' => 'vars',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
                'filter' => ['json', 'encrypt']
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Events',
                'key' => 'events',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => true,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Schedule',
                'key' => 'schedule',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Previous',
                'key' => 'previous',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Next',
                'key' => 'next',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Timeout',
                'key' => 'timeout',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
        'indexes' => [
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system1',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'name',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system2',
                'type' => Database::INDEX_FULLTEXT,
                'attributes' => [
                    'name',
                ],
            ],
        ],
    ],
    Database::COLLECTION_TAGS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_TAGS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Tags',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Created',
                'key' => 'dateCreated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Function ID',
                'key' => 'functionId',
                'type' => Database::VAR_KEY,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Command',
                'key' => 'command',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Code Path',
                'key' => 'path',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Code Size',
                'key' => 'size',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
        'indexes' => [
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system1',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'functionId',
                ],
            ],
        ],
    ],
    Database::COLLECTION_EXECUTIONS => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_EXECUTIONS,
        '$permissions' => ['read' => ['*']],
        'name' => 'Executions',
        'rules' => [
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Date Created',
                'key' => 'dateCreated',
                'type' => Database::VAR_INTEGER,
                'default' => 0,
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Function ID',
                'key' => 'functionId',
                'type' => Database::VAR_KEY,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Tag ID',
                'key' => 'tagId',
                'type' => Database::VAR_KEY,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Trigger',
                'key' => 'trigger',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Status',
                'key' => 'status',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Exit Code',
                'key' => 'exitCode',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Stdout',
                'key' => 'stdout',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Stderr',
                'key' => 'stderr',
                'type' => Database::VAR_TEXT,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
            [
                '$collection' => Database::COLLECTION_RULES,
                'label' => 'Time',
                'key' => 'time',
                'type' => Database::VAR_INTEGER,
                'default' => '',
                'required' => false,
                'array' => false,
            ],
        ],
        'indexes' => [
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system1',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'functionId',
                ],
            ],
            [
                '$collection' => Database::COLLECTION_INDEXES,
                '$id' => 'system2',
                'type' => Database::INDEX_KEY,
                'attributes' => [
                    'tagId',
                ],
            ],
        ],
    ],
    Database::COLLECTION_RESERVED => [
        '$collection' => Database::COLLECTION_COLLECTIONS,
        '$id' => Database::COLLECTION_RESERVED,
        '$permissions' => ['read' => ['*']],
        'name' => 'Reserved',
        'structure' => true,
    ],
];

/*
 * Add enabled OAuth2 providers to default data rules
 */
foreach ($providers as $index => $provider) {
    if (!$provider['enabled']) {
        continue;
    }

    $collections[Database::COLLECTION_PROJECTS]['rules'][] = [
        '$collection' => Database::COLLECTION_RULES,
        'label' => 'OAuth2 '.\ucfirst($index).' ID',
        'key' => 'usersOauth2'.\ucfirst($index).'Appid',
        'type' => Database::VAR_TEXT,
        'default' => '',
        'required' => false,
        'array' => false,
    ];

    $collections[Database::COLLECTION_PROJECTS]['rules'][] = [
        '$collection' => Database::COLLECTION_RULES,
        'label' => 'OAuth2 '.\ucfirst($index).' Secret',
        'key' => 'usersOauth2'.\ucfirst($index).'Secret',
        'type' => Database::VAR_TEXT,
        'default' => '',
        'required' => false,
        'array' => false,
    ];

    $collections[Database::COLLECTION_USERS]['rules'][] = [
        '$collection' => Database::COLLECTION_RULES,
        'label' => 'OAuth2 '.\ucfirst($index).' ID',
        'key' => 'oauth2'.\ucfirst($index),
        'type' => Database::VAR_TEXT,
        'default' => '',
        'required' => false,
        'array' => false,
    ];

    $collections[Database::COLLECTION_USERS]['rules'][] = [
        '$collection' => Database::COLLECTION_RULES,
        'label' => 'OAuth2 '.\ucfirst($index).' Access Token',
        'key' => 'oauth2'.\ucfirst($index).'AccessToken',
        'type' => Database::VAR_TEXT,
        'default' => '',
        'required' => false,
        'array' => false,
    ];
}

return $collections;